{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Gestión de Carpetas y Documentos</title>
  <link rel="stylesheet" href="{% static 'css/carpeta.css' %}?v={{ timestamp }}">
</head>
<body>
  <div class="headermenu">
    <div class="hmenu">
      <img src="{% static 'diseños/imagenes/logo.png' %}" alt="logo" class="img">
      <h4>Maderas <span>Isabella</span></h4>
    </div>
  </div>

  <div class="main-content">
    <!-- Menú vertical (Sidebar) -->
    <div class="sidebar">
      <h2> Menú</h2>
      <div class="menu">
        <a href="{% url 'index' %}">Inicio</a>
        <a href="{% url 'gestionar_productos' %}">Galería de Publicidad</a>
        <a href="{% url 'lista_login' %}">Listado de Cuentas</a>
        <a href="{% url 'carpeta' %}">Documentos de contratación</a>
        <a href="{% url 'manage_backups' %}">Gestion de BD (backups)</a>
        <a href="{% url 'logout' %}">Cerrar Sesión</a>
      </div>
    </div>

    <div class="container">
      <!-- Título principal -->
      <h1>Gestión de Carpetas y Documentos</h1>

      <!-- Botones superiores: ahora sólo "Crear Nuevo Trabajador" y Volver -->
      <div class="form-group top-buttons">
        <button id="openNewFolderModalBtn" class="btn">Crear Nuevo Trabajador</button>
        <a href="{% url 'index' %}" class="btn">Volver al Inicio</a>
        <div class="form-group download-buttons">
          <button id="downloadPdfBtn" class="btn" disabled>Descargar Prestaciones en PDF</button>
          <button id="downloadExcelBtn" class="btn" disabled>Descargar Prestaciones en Excel</button>
        </div>
      </div>

      <!-- Barra de búsqueda de carpetas -->
      <div class="form-group">
        <input type="text" id="searchInput" placeholder="Buscar carpeta...">
      </div>

      <!-- Contenedor donde se mostrarán las carpetas creadas -->
      <div id="foldersContainer"></div>
    </div>

    <!-- Modal para crear carpeta (input + botón) -->
    <div id="modal-nueva-carpeta" class="hidden">
      <div id="modal-content-nueva-carpeta">
        <h2>Crear Carpeta</h2>
        <span class="close-btn" onclick="closeNewFolderModal()">&times;</span>
        <div class="form-group">
          <input type="text" id="folderName" placeholder="Nombre de la carpeta">
          {% csrf_token %}
          <button id="createFolderBtn" class="btn">Crear Carpeta</button>
        </div>
      </div>
    </div>

    <!-- Modal para editar prestaciones -->
    <div id="modal-editar" style="display:none;">
      <div id="modal-content-editar">
        <h2>Editar Prestaciones de Servicio</h2>
        <div id="benefitsForm" class="barra">
          <!-- ... campos existentes ... -->
        </div>
        <div style="text-align: right; margin-top: 10px;">
          <button id="saveBenefitsBtn" class="btn">Guardar Prestaciones</button>
          <button id="closeModalBtn" class="btn" style="background: #6c757d;">Cerrar</button>
        </div>
      </div>
    </div>

    <!-- Modal para mostrar prestaciones guardadas -->
    <div id="modal-mostrar" style="display:none;">
      <div id="modal-content-mostrar">
        <h2>Prestaciones de Servicio</h2>
        <div id="benefitsDisplayContent"></div>
        <div style="text-align: right; margin-top: 10px;">
          <button id="closeShowBenefitsBtn" class="btn" style="background: #6c757d;">Cerrar</button>
        </div>
      </div>
    </div>

    <!-- Modal para ver el archivo (PDF, imagen, etc.) -->
    <div id="modal-ver" style="display:none;">
      <div id="modal-content-ver" style="width:80%; height:80%;">
        <h2>Vista del Archivo</h2>
        <div style="width:100%; height: calc(100% - 50px);">
          <iframe id="fileIframe" src="" style="width:100%; height:100%; border: none;"></iframe>
        </div>
        <div style="text-align: right; margin-top: 10px;">
          <button id="closeFileModalBtn" class="btn" style="background: #6c757d;">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Abrir modal de nueva carpeta
    document.getElementById('openNewFolderModalBtn').addEventListener('click', openNewFolderModal);
    function openNewFolderModal() {
      document.getElementById('modal-nueva-carpeta').style.display = 'block';
    }
    // Cerrar modal de nueva carpeta
    function closeNewFolderModal() {
      document.getElementById('modal-nueva-carpeta').style.display = 'none';
    }
  </script>
  <script src="{% static 'js/carpeta.js' %}"></script>
</body>
</html>
